--Average time: 193.90595947265626 ms, --model: facebook/opt-1.3b, --batch size: 4, --sequence length: 512, --data: dataset/train_opt.jsonl, --device: cuda, --file_name: exposer_lora.py
Generating '/tmp/nsys-report-b674.qdstrm'
[1/8] [0%                          ] report6.nsys-rep[1/8] [0%                          ] report6.nsys-rep[1/8] [0%                          ] report6.nsys-rep[1/8] [0%                          ] report6.nsys-rep[1/8] [6%                          ] report6.nsys-rep[1/8] [5%                          ] report6.nsys-rep[1/8] [8%                          ] report6.nsys-rep[1/8] [7%                          ] report6.nsys-rep[1/8] [6%                          ] report6.nsys-rep[1/8] [9%                          ] report6.nsys-rep[1/8] [10%                         ] report6.nsys-rep[1/8] [12%                         ] report6.nsys-rep[1/8] [13%                         ] report6.nsys-rep[1/8] [14%                         ] report6.nsys-rep[1/8] [=15%                        ] report6.nsys-rep[1/8] [=16%                        ] report6.nsys-rep[1/8] [=17%                        ] report6.nsys-rep[1/8] [==18%                       ] report6.nsys-rep[1/8] [==19%                       ] report6.nsys-rep[1/8] [==20%                       ] report6.nsys-rep[1/8] [==21%                       ] report6.nsys-rep[1/8] [===22%                      ] report6.nsys-rep[1/8] [===23%                      ] report6.nsys-rep[1/8] [===24%                      ] report6.nsys-rep[1/8] [====25%                     ] report6.nsys-rep[1/8] [====26%                     ] report6.nsys-rep[1/8] [====27%                     ] report6.nsys-rep[1/8] [====28%                     ] report6.nsys-rep[1/8] [=====29%                    ] report6.nsys-rep[1/8] [=====30%                    ] report6.nsys-rep[1/8] [=====31%                    ] report6.nsys-rep[1/8] [=====32%                    ] report6.nsys-rep[1/8] [======33%                   ] report6.nsys-rep[1/8] [======34%                   ] report6.nsys-rep[1/8] [======35%                   ] report6.nsys-rep[1/8] [=======36%                  ] report6.nsys-rep[1/8] [=======37%                  ] report6.nsys-rep[1/8] [=======38%                  ] report6.nsys-rep[1/8] [=======39%                  ] report6.nsys-rep[1/8] [========40%                 ] report6.nsys-rep[1/8] [========41%                 ] report6.nsys-rep[1/8] [========42%                 ] report6.nsys-rep[1/8] [=========43%                ] report6.nsys-rep[1/8] [=========44%                ] report6.nsys-rep[1/8] [=========45%                ] report6.nsys-rep[1/8] [=========46%                ] report6.nsys-rep[1/8] [==========47%               ] report6.nsys-rep[1/8] [==========48%               ] report6.nsys-rep[1/8] [==========49%               ] report6.nsys-rep[1/8] [===========50%              ] report6.nsys-rep[1/8] [===========51%              ] report6.nsys-rep[1/8] [===========52%              ] report6.nsys-rep[1/8] [===========53%              ] report6.nsys-rep[1/8] [============54%             ] report6.nsys-rep[1/8] [============55%             ] report6.nsys-rep[1/8] [============56%             ] report6.nsys-rep[1/8] [============57%             ] report6.nsys-rep[1/8] [=============58%            ] report6.nsys-rep[1/8] [=============59%            ] report6.nsys-rep[1/8] [=============60%            ] report6.nsys-rep[1/8] [==============61%           ] report6.nsys-rep[1/8] [==============62%           ] report6.nsys-rep[1/8] [==============63%           ] report6.nsys-rep[1/8] [==============64%           ] report6.nsys-rep[1/8] [===============65%          ] report6.nsys-rep[1/8] [===============66%          ] report6.nsys-rep[1/8] [===============67%          ] report6.nsys-rep[1/8] [================68%         ] report6.nsys-rep[1/8] [================69%         ] report6.nsys-rep[1/8] [================70%         ] report6.nsys-rep[1/8] [================71%         ] report6.nsys-rep[1/8] [=================72%        ] report6.nsys-rep[1/8] [=================73%        ] report6.nsys-rep[1/8] [=================74%        ] report6.nsys-rep[1/8] [==================75%       ] report6.nsys-rep[1/8] [==================76%       ] report6.nsys-rep[1/8] [==================77%       ] report6.nsys-rep[1/8] [==================78%       ] report6.nsys-rep[1/8] [===================79%      ] report6.nsys-rep[1/8] [===================80%      ] report6.nsys-rep[1/8] [===================81%      ] report6.nsys-rep[1/8] [===================82%      ] report6.nsys-rep[1/8] [====================83%     ] report6.nsys-rep[1/8] [====================84%     ] report6.nsys-rep[1/8] [====================85%     ] report6.nsys-rep[1/8] [=====================86%    ] report6.nsys-rep[1/8] [=====================87%    ] report6.nsys-rep[1/8] [=====================88%    ] report6.nsys-rep[1/8] [=====================89%    ] report6.nsys-rep[1/8] [======================90%   ] report6.nsys-rep[1/8] [======================91%   ] report6.nsys-rep[1/8] [======================92%   ] report6.nsys-rep[1/8] [=======================93%  ] report6.nsys-rep[1/8] [=======================94%  ] report6.nsys-rep[1/8] [=======================95%  ] report6.nsys-rep[1/8] [========================100%] report6.nsys-rep[1/8] [========================100%] report6.nsys-rep
[2/8] [0%                          ] report6.sqlite[2/8] [1%                          ] report6.sqlite[2/8] [2%                          ] report6.sqlite[2/8] [3%                          ] report6.sqlite[2/8] [4%                          ] report6.sqlite[2/8] [5%                          ] report6.sqlite[2/8] [6%                          ] report6.sqlite[2/8] [7%                          ] report6.sqlite[2/8] [8%                          ] report6.sqlite[2/8] [9%                          ] report6.sqlite[2/8] [10%                         ] report6.sqlite[2/8] [11%                         ] report6.sqlite[2/8] [12%                         ] report6.sqlite[2/8] [13%                         ] report6.sqlite[2/8] [14%                         ] report6.sqlite[2/8] [=15%                        ] report6.sqlite[2/8] [=16%                        ] report6.sqlite[2/8] [=17%                        ] report6.sqlite[2/8] [==18%                       ] report6.sqlite[2/8] [==19%                       ] report6.sqlite[2/8] [==20%                       ] report6.sqlite[2/8] [==21%                       ] report6.sqlite[2/8] [===22%                      ] report6.sqlite[2/8] [===23%                      ] report6.sqlite[2/8] [===24%                      ] report6.sqlite[2/8] [====25%                     ] report6.sqlite[2/8] [====26%                     ] report6.sqlite[2/8] [====27%                     ] report6.sqlite[2/8] [====28%                     ] report6.sqlite[2/8] [=====29%                    ] report6.sqlite[2/8] [=====30%                    ] report6.sqlite[2/8] [=====31%                    ] report6.sqlite[2/8] [=====32%                    ] report6.sqlite[2/8] [======33%                   ] report6.sqlite[2/8] [======34%                   ] report6.sqlite[2/8] [======35%                   ] report6.sqlite[2/8] [=======36%                  ] report6.sqlite[2/8] [=======37%                  ] report6.sqlite[2/8] [=======38%                  ] report6.sqlite[2/8] [=======39%                  ] report6.sqlite[2/8] [========40%                 ] report6.sqlite[2/8] [========41%                 ] report6.sqlite[2/8] [========42%                 ] report6.sqlite[2/8] [=========43%                ] report6.sqlite[2/8] [=========44%                ] report6.sqlite[2/8] [=========45%                ] report6.sqlite[2/8] [=========46%                ] report6.sqlite[2/8] [==========47%               ] report6.sqlite[2/8] [==========48%               ] report6.sqlite[2/8] [==========49%               ] report6.sqlite[2/8] [===========50%              ] report6.sqlite[2/8] [===========51%              ] report6.sqlite[2/8] [===========52%              ] report6.sqlite[2/8] [===========53%              ] report6.sqlite[2/8] [============54%             ] report6.sqlite[2/8] [============55%             ] report6.sqlite[2/8] [============56%             ] report6.sqlite[2/8] [============57%             ] report6.sqlite[2/8] [=============58%            ] report6.sqlite[2/8] [=============59%            ] report6.sqlite[2/8] [=============60%            ] report6.sqlite[2/8] [==============61%           ] report6.sqlite[2/8] [==============62%           ] report6.sqlite[2/8] [==============63%           ] report6.sqlite[2/8] [==============64%           ] report6.sqlite[2/8] [===============65%          ] report6.sqlite[2/8] [===============66%          ] report6.sqlite[2/8] [===============67%          ] report6.sqlite[2/8] [================68%         ] report6.sqlite[2/8] [================69%         ] report6.sqlite[2/8] [================70%         ] report6.sqlite[2/8] [================71%         ] report6.sqlite[2/8] [=================72%        ] report6.sqlite[2/8] [=================73%        ] report6.sqlite[2/8] [=================74%        ] report6.sqlite[2/8] [==================75%       ] report6.sqlite[2/8] [==================76%       ] report6.sqlite[2/8] [==================77%       ] report6.sqlite[2/8] [==================78%       ] report6.sqlite[2/8] [===================79%      ] report6.sqlite[2/8] [===================80%      ] report6.sqlite[2/8] [===================81%      ] report6.sqlite[2/8] [===================82%      ] report6.sqlite[2/8] [====================83%     ] report6.sqlite[2/8] [====================84%     ] report6.sqlite[2/8] [====================85%     ] report6.sqlite[2/8] [=====================86%    ] report6.sqlite[2/8] [=====================87%    ] report6.sqlite[2/8] [=====================88%    ] report6.sqlite[2/8] [=====================89%    ] report6.sqlite[2/8] [======================90%   ] report6.sqlite[2/8] [======================91%   ] report6.sqlite[2/8] [======================92%   ] report6.sqlite[2/8] [=======================93%  ] report6.sqlite[2/8] [=======================94%  ] report6.sqlite[2/8] [=======================95%  ] report6.sqlite[2/8] [=======================96%  ] report6.sqlite[2/8] [========================97% ] report6.sqlite[2/8] [========================98% ] report6.sqlite[2/8] [========================99% ] report6.sqlite[2/8] [========================100%] report6.sqlite[2/8] [========================100%] report6.sqlite
[3/8] Executing 'nvtx_sum' stats report
[4/8] Executing 'osrt_sum' stats report

 Time (%)   Total Time (ns)   Num Calls     Avg (ns)        Med (ns)      Min (ns)      Max (ns)       StdDev (ns)             Name         
 --------  -----------------  ---------  ---------------  -------------  ----------  --------------  ---------------  ----------------------
     97.8  1,017,721,378,013        186  5,471,620,311.9  105,088,944.5     379,137  15,962,804,448  7,513,899,739.7  pthread_cond_wait     
      1.8     18,646,350,169        200     93,231,750.8  100,112,920.0       3,657     292,178,377     31,204,253.7  poll                  
      0.2      1,794,605,376        129     13,911,669.6   12,344,214.0         120      33,894,045     11,118,084.2  pthread_mutex_lock    
      0.1      1,496,464,179      2,907        514,779.6      478,836.0       1,132      13,042,315        488,449.2  open64                
      0.1        604,715,649      3,071        196,911.6       63,159.0         230      43,575,471        990,252.5  ioctl                 
      0.0        136,993,611      7,562         18,116.1        1,843.5         220      28,226,793        454,625.0  read                  
      0.0         72,178,574  1,239,608             58.2           50.0          40          19,026            115.1  pthread_cond_signal   
      0.0         40,441,232          8      5,055,154.0    5,058,285.0   5,031,990       5,059,592          9,381.3  nanosleep             
      0.0         34,134,640          2     17,067,320.0   17,067,320.0  12,432,121      21,702,519      6,555,161.3  fork                  
      0.0         33,106,194          4      8,276,548.5    7,885,243.0     364,269      16,971,439      9,131,361.2  waitpid               
      0.0         30,993,315         74        418,828.6      504,825.5         852         852,092        226,398.1  open                  
      0.0         30,030,456        132        227,503.5      208,614.5     180,771       1,496,290        118,962.4  pthread_create        
      0.0         14,864,709        414         35,905.1        6,833.0       2,395       3,502,877        265,042.2  mmap                  
      0.0         10,688,598      2,866          3,729.4        3,196.0       1,783         970,716         18,374.1  mmap64                
      0.0          9,890,276      2,988          3,310.0          931.0         782          76,404          9,769.3  munmap                
      0.0          8,059,385         63        127,926.7       16,060.0         210       4,980,292        646,238.4  pthread_join          
      0.0          5,148,734     12,545            410.4           71.0          49          54,293          2,274.9  fgets                 
      0.0          1,989,873         41         48,533.5       54,603.0         641          80,523         21,521.8  pthread_rwlock_wrlock 
      0.0          1,466,204          8        183,275.5        5,741.0       3,006         716,325        278,653.4  fopen64               
      0.0          1,095,735        116          9,446.0        4,433.0       1,252         358,247         33,114.3  fopen                 
      0.0          1,017,470        130          7,826.7        4,177.5       3,447         276,814         24,833.4  mprotect              
      0.0            782,972         11         71,179.3       38,082.0      23,645         423,631        117,063.0  sem_timedwait         
      0.0            535,768        113          4,741.3        3,767.0       1,363          46,808          4,966.5  fclose                
      0.0            305,844         48          6,371.8        5,696.0         992          15,199          3,032.0  write                 
      0.0            168,995      1,929             87.6           80.0          49             662             43.8  pthread_cond_broadcast
      0.0            111,341          1        111,341.0      111,341.0     111,341         111,341              0.0  pthread_cond_timedwait
      0.0             93,339      1,074             86.9           60.0          49           7,464            286.6  fgets_unlocked        
      0.0             90,822         31          2,929.7        2,885.0       1,914           4,618            727.1  pread                 
      0.0             68,560          1         68,560.0       68,560.0      68,560          68,560              0.0  pthread_rwlock_rdlock 
      0.0             62,080        198            313.5          171.0          40           3,006            342.9  sigaction             
      0.0             61,100        129            473.6          391.0          40           1,553            317.4  sleep                 
      0.0             44,267        384            115.3           50.0          40           2,195            195.0  pthread_mutex_trylock 
      0.0             39,024          3         13,008.0       11,101.0       9,588          18,335          4,674.9  connect               
      0.0             38,603          3         12,867.7       12,183.0      11,512          14,908          1,798.5  fread                 
      0.0             37,185        124            299.9          250.0         150           1,343            176.9  fcntl                 
      0.0             31,247          5          6,249.4        4,879.0       3,536          10,840          3,065.1  socket                
      0.0             30,328          7          4,332.6        5,310.0       1,503           7,575          2,636.8  pipe2                 
      0.0             14,816        106            139.8           40.0          40           8,045            797.4  flockfile             
      0.0              7,073          2          3,536.5        3,536.5       1,342           5,731          3,103.5  bind                  
      0.0              6,396         32            199.9           51.0          40           1,844            368.8  fflush                
      0.0              5,300          3          1,766.7        1,904.0         751           2,645            954.4  dup2                  
      0.0              4,990          2          2,495.0        2,495.0       1,934           3,056            793.4  recvfrom              
      0.0              3,526          8            440.8          285.5         170           1,172            372.5  dup                   
      0.0                601          1            601.0          601.0         601             601              0.0  listen                

[5/8] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)    Max (ns)    StdDev (ns)                      Name                     
 --------  ---------------  ---------  -----------  -----------  ---------  -----------  -----------  ---------------------------------------------
     48.7    1,768,231,318    182,700      9,678.3      6,463.0      4,268  360,835,110    851,356.5  cudaLaunchKernel                             
     18.1      658,725,515     21,291     30,939.2      9,748.0      4,648   25,835,900    319,578.7  cudaMemcpyAsync                              
      8.9      323,944,990      9,579     33,818.2     11,671.0      3,477    3,114,252    218,533.0  cudaStreamSynchronize                        
      8.8      319,692,404      3,025    105,683.4      6,001.0      5,240   37,543,188  1,695,113.2  cudaDeviceSynchronize                        
      5.9      215,884,128     23,970      9,006.4      9,147.0      6,312       63,179      1,551.0  cuLaunchKernel                               
      2.8      102,476,612        292    350,947.3    351,215.0      3,277      725,202    114,933.3  cudaMalloc                                   
      2.2       78,262,859     25,018      3,128.3      3,156.0      1,172       57,168      1,178.5  cudaEventRecord                              
      2.1       74,671,289     10,311      7,241.9      6,523.0      5,320       53,410      1,888.6  cudaMemsetAsync                              
      0.7       26,104,813     16,188      1,612.6      1,623.0        511       79,230        873.1  cudaEventCreateWithFlags                     
      0.4       14,186,431     16,114        880.4        761.0        631       14,026        464.2  cudaEventDestroy                             
      0.3       12,269,885          7  1,752,840.7      1,954.0        781   10,359,710  3,860,821.4  cudaFree                                     
      0.3       10,984,560      5,926      1,853.6      1,272.0        692    3,194,214     41,482.4  cudaOccupancyMaxActiveBlocksPerMultiprocessor
      0.2        7,954,349          3  2,651,449.7  3,142,255.0  1,546,897    3,265,197    958,543.8  cudaGetDeviceProperties_v2_v12000            
      0.2        7,417,504      9,123        813.1        762.0        521       17,523        506.9  cudaStreamIsCapturing_v10000                 
      0.1        3,269,243         29    112,732.5    109,977.0     59,503      210,829     38,776.1  cuModuleLoadData                             
      0.1        2,562,328         32     80,072.8      2,239.0      1,953    2,007,989    356,704.5  cudaStreamCreateWithFlags                    
      0.0        1,567,937          4    391,984.3    416,919.0    246,867      487,232    104,485.6  cuLibraryUnload                              
      0.0        1,108,377         14     79,169.8      5,941.0      3,116    1,000,844    265,345.0  cudaHostAlloc                                
      0.0          762,641      1,915        398.2        341.0        170       15,189        410.9  cuGetProcAddress_v2                          
      0.0            8,166          5      1,633.2      1,353.0        481        3,667      1,205.4  cuInit                                       
      0.0            5,940          6        990.0        335.5        230        4,098      1,528.3  cuModuleGetLoadingMode                       

[6/8] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  ----------------------------------------------------------------------------------------------------
     13.1      850,661,386      5,176    164,347.3    164,671.0    160,255    169,439      2,046.3  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<int>, at::detail::Ar…
      9.5      614,265,529     41,175     14,918.4      5,727.0      2,336    544,862     30,711.3  void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterator…
      9.1      586,728,592      8,479     69,197.9     69,184.0     67,648     70,208        484.8  sm80_xmma_gemm_f16f16_f16f32_f32_nn_n_tilesize160x128x32_stage4_warpsize2x2x1_tensor16x8x16_kernel  
      7.1      461,934,511      5,856     78,882.3     78,848.0     78,208    102,175        642.9  ampere_fp16_s16816gemm_fp16_128x128_ldg8_relu_f2f_stages_32x5_tn                                    
      4.9      316,018,647     10,065     31,397.8     29,728.0      1,888     36,224      3,559.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, at::deta…
      4.1      266,475,996      2,866     92,978.4     93,216.0     25,408    108,736     11,386.5  _fc1_bwd_kernel_0d1d2d3de4de5de6de7c8c9de10de11c12d                                                 
      4.0      260,910,725      2,928     89,108.9     89,088.0     87,616    114,559        649.6  _sdd_kernel_0d1d2d3de4de5de6c7de8de9c10de11de12de13de14c15de16de17d                                 
      3.9      252,718,735      2,891     87,415.7     83,039.0     46,623    114,048     10,085.2  _fc2_bwd_kernel_0d1d2d3de4de5de6de7c8c9de10de11c12d                                                 
      3.5      229,268,365     13,115     17,481.4     19,104.0      3,328     25,728      7,881.3  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      3.5      226,692,483      3,216     70,489.0     51,936.0     22,144    115,583     35,577.8  _fc1_fwd_kernel_0d1d2d3de4de5de6de7c8de9c10de11c12d                                                 
      3.3      215,750,127      2,928     73,685.2     73,632.0     72,224     75,487        452.3  sm80_xmma_gemm_f16f16_f16f32_f32_nt_n_tilesize160x128x32_stage3_warpsize2x2x1_tensor16x8x16_kernel  
      3.2      208,170,896      2,928     71,096.6     71,072.0     70,720     92,127        550.7  sm80_xmma_gemm_f16f16_f16f32_f32_tn_n_tilesize160x128x32_stage4_warpsize2x2x1_tensor16x8x16_kernel  
      2.9      190,497,965     12,993     14,661.6     18,528.0      3,327    542,782     37,030.8  void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterator…
      2.2      140,492,144      3,346     41,988.1     32,288.5     20,097     68,000     18,286.5  _fc2_fwd_kernel_0d1d2d3de4de5de6de7c8de9c10de11c12d                                                 
      1.9      125,516,737      2,928     42,867.7     42,848.0     39,488     45,919        779.6  void at::native::<unnamed>::layer_norm_grad_input_kernel_vectorized<float, float>(const T1 *, const…
      1.9      123,922,665      2,867     43,223.8     43,104.0     41,311     47,520        786.4  _dsd_kernel_0d1d2d3de4de5c6de7de8de9de10c11de12de13de14c15de16de17d                                 
      1.8      114,913,957      2,928     39,246.6     39,616.0     29,567     40,255      1,875.4  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      1.6      106,563,346      2,928     36,394.6     36,384.0     35,520     46,400        357.3  _dsd_kernel_0d1d2d3de4de5de6c7de8de9de10c11de12de13de14c15de16de17d                                 
      1.5       97,319,115         61  1,595,395.3  1,595,354.0  1,593,786  1,597,403        942.6  ampere_fp16_s16816gemm_fp16_256x128_ldg8_f2f_stages_64x3_tn                                         
      1.4       91,758,811         61  1,504,242.8  1,504,155.0  1,503,131  1,506,266        510.7  ampere_fp16_s16816gemm_fp16_256x128_ldg8_f2f_stages_32x3_nn                                         
      1.4       89,630,137      2,928     30,611.4     30,592.0     30,272     39,456        250.6  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      1.2       75,300,483      1,464     51,434.8     51,424.0     51,104     65,727        387.3  _blocksparse_softmax_fwd_0d1d2de3d4de5c6c7c89                                                       
      1.2       74,558,448      1,464     50,927.9     50,912.0     50,208     51,552        120.9  _blocksparse_softmax_bwd_0d1de2d3de4d5de67d8de9c10c11c12c13                                         
      1.1       73,982,575      2,989     24,751.6     24,864.0     22,912     30,944        873.0  void at::native::<unnamed>::vectorized_layer_norm_kernel<float, float>(int, T2, const T1 *, const T…
      1.0       67,737,624      2,989     22,662.3     13,792.0     13,280    450,718     61,504.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<c10::Half>, at::…
      1.0       62,205,357      2,928     21,245.0     21,248.0     20,960     21,600         73.9  void cutlass_cudnn_infer::Kernel<cutlass_tensorop_f16_s16816dgrad_optimized_f16_64x128_32x6_nhwc_un…
      0.8       51,680,327      4,392     11,766.9     15,744.0      3,648     22,336      5,672.5  void cutlass::Kernel<cutlass_80_wmma_tensorop_f16_s161616gemm_f16_32x32_32x1_nn_align2>(T1::Params) 
      0.8       49,109,037      1,464     33,544.4     33,568.0     32,608     37,056        301.0  void at::native::unrolled_elementwise_kernel<at::native::CUDAFunctor_add<float>, at::detail::Array<…
      0.8       48,917,737      5,856      8,353.4      8,400.0      6,880     10,176      1,308.8  void cudnn::ops::nchwToNhwcKernel<__half, __half, float, (bool)0, (bool)1, (cudnnKernelDataType_t)0…
      0.7       48,022,438      5,856      8,200.6      8,224.0      7,680     10,944        122.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<c10::Half, c10::Ha…
      0.7       46,899,349      5,856      8,008.8      7,904.0      7,807     10,336        170.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<c10::Half>, at::deta…
      0.6       37,047,619         61    607,338.0    607,262.0    603,998    612,477      1,766.8  void at::native::<unnamed>::cunn_SoftMaxBackward<(int)8, c10::Half, float, c10::Half, at::native::<…
      0.5       35,017,159         61    574,051.8    574,079.0    571,743    577,566      1,348.5  void at::native::<unnamed>::cunn_SoftMaxForward<(int)8, c10::Half, float, c10::Half, at::native::<u…
      0.5       31,665,487      2,928     10,814.7     10,816.0     10,624     11,200         56.4  void cutlass::Kernel<cutlass_80_wmma_tensorop_s161616gemm_f16_32x32_128x1_tn_align2>(T1::Params)    
      0.4       23,355,462         61    382,876.4    382,879.0    382,591    383,391        131.5  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl<at::native::…
      0.3       17,072,793        497     34,351.7      1,697.0      1,536    268,575     86,988.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, at::detail::…
      0.3       16,857,196      2,928      5,757.2      5,775.5      5,408      7,616        281.2  void cutlass::Kernel<cutlass_80_tensorop_f16_s16816gemm_relu_f16_64x64_64x6_tn_align8>(T1::Params)  
      0.3       16,719,278      1,464     11,420.3     11,424.0     11,040     12,448        136.5  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<long, at::native::func_wrappe…
      0.2       15,432,241      4,392      3,513.7      3,392.0      3,327      4,833        209.3  void splitKreduce_kernel<(int)32, (int)16, int, __half, __half, float, __half, (bool)1, (bool)1, (b…
      0.2       12,853,638      1,464      8,779.8      8,768.0      8,511     11,167        125.0  ampere_fp16_s16816gemm_fp16_64x64_ldg8_f2f_stages_64x6_tn                                           
      0.2       10,881,485      1,464      7,432.7      7,424.0      6,688      8,704        211.5  void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void …
      0.2       10,551,641         61    172,977.7    172,991.0    171,647    174,751        638.3  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<c10::Half, at::native::func_w…
      0.1        8,935,129      1,464      6,103.2      6,080.0      5,888      6,368         72.2  void at::native::reduce_kernel<(int)128, (int)4, at::native::ReduceOp<c10::Half, at::native::func_w…
      0.1        8,393,246      2,928      2,866.5      2,624.0      2,528      3,456        297.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorIt…
      0.1        8,250,087      2,928      2,817.7      2,816.0      2,752      2,849         14.3  void splitKreduce_kernel<(int)32, (int)16, int, float, float, float, float, (bool)1, (bool)0, (bool…
      0.1        7,503,066      2,928      2,562.5      2,560.0      2,496      2,753         30.6  void cudnn::ops::nhwcToNchwKernel<__half, __half, float, (bool)1, (bool)0, (cudnnKernelDataType_t)0…
      0.1        6,642,120      1,525      4,355.5      4,384.0      3,744      5,631        123.3  void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterator…
      0.1        6,377,989      2,928      2,178.3      2,176.0      2,112      2,209         19.4  void cudnn::cnn::reduce_wgrad_nchw_helper<float, __half>(void *, const void *, T1, int, int)        
      0.1        5,471,053        122     44,844.7     45,823.5     42,368     58,848      2,395.8  void at::native::<unnamed>::indexSelectLargeIndex<float, long, unsigned int, (int)2, (int)2, (int)-…
      0.1        3,461,915      1,464      2,364.7      2,368.0      2,239      3,008         52.5  void at_cuda_detail::cub::DeviceSelectSweepKernel<at_cuda_detail::cub::DispatchSelectIf<at_cuda_det…
      0.1        3,394,548      1,464      2,318.7      2,304.0      2,303      2,976         23.4  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<c10::…
      0.1        3,274,213      1,464      2,236.5      2,240.0      2,112      2,881         70.1  void at_cuda_detail::cub::DeviceReduceSingleTileKernel<at_cuda_detail::cub::DeviceReducePolicy<int,…
      0.0        2,449,860      1,464      1,673.4      1,696.0      1,567      2,176         42.1  void at_cuda_detail::cub::DeviceCompactInitKernel<at_cuda_detail::cub::ScanTileState<int, (bool)1>,…
      0.0        1,106,399        122      9,068.8      9,056.0      8,864      9,440        119.5  void at::native::<unnamed>::multi_tensor_apply_kernel<at::native::<unnamed>::TensorListScalarListMe…
      0.0          959,613        122      7,865.7      7,152.5      6,047      9,632      1,062.4  void at::native::<unnamed>::multi_tensor_apply_kernel<at::native::<unnamed>::TensorListMetadata<(in…
      0.0          939,331        122      7,699.4      7,712.0      5,184      8,577        298.3  void at::native::<unnamed>::multi_tensor_apply_kernel<at::native::<unnamed>::TensorListMetadata<(in…
      0.0          925,788        305      3,035.4      2,656.0      1,887      5,792      1,148.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::<unnamed>::masked_fill_kernel(at…
      0.0          868,411        122      7,118.1      7,215.5      6,656      9,152        402.8  void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterator…
      0.0          713,055        122      5,844.7      5,920.0      5,536      6,431        209.5  void at::native::<unnamed>::multi_tensor_apply_kernel<at::native::<unnamed>::TensorListMetadata<(in…
      0.0          643,297        122      5,272.9      5,280.0      5,184      5,376         42.3  void at::native::<unnamed>::multi_tensor_apply_kernel<at::native::<unnamed>::TensorListMetadata<(in…
      0.0          502,911        122      4,122.2      4,016.0      3,711      4,640        301.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrapp…
      0.0          487,297         61      7,988.5      7,968.0      7,841      8,224         78.1  void at::native::<unnamed>::multi_tensor_apply_kernel<at::native::<unnamed>::TensorListScalarListMe…
      0.0          477,561        244      1,957.2      1,888.0      1,823      4,448        222.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floa…
      0.0          389,606         61      6,387.0      6,368.0      6,240      8,224        245.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          389,599         61      6,386.9      6,367.0      6,240      8,544        283.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          370,782        183      2,026.1      2,016.0      1,888      2,624         92.4  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<long>, at:…
      0.0          305,023         61      5,000.4      4,992.0      4,800      5,216         87.5  void at::native::<unnamed>::multi_tensor_apply_kernel<at::native::<unnamed>::TensorListMetadata<(in…
      0.0          296,190         61      4,855.6      4,801.0      4,672      5,632        149.3  void at::native::<unnamed>::nll_loss_backward_no_reduce_cuda_kernel<float, long>(int, const T2 *, a…
      0.0          278,432         61      4,564.5      4,544.0      4,352      5,792        167.4  void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          274,176        122      2,247.3      2,080.0      1,887      2,848        360.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIterat…
      0.0          263,582         61      4,321.0      4,320.0      4,161      4,512         74.5  void at::native::<unnamed>::nll_loss_forward_no_reduce_cuda_kernel<float, long>(long, at::GenericPa…
      0.0          260,839        122      2,138.0      2,143.5      1,856      2,496        191.8  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      0.0          243,520         61      3,992.1      3,936.0      3,904      5,152        157.7  void at::native::tensor_kernel_scan_innermost_dim<long, std::plus<long>>(T1 *, const T1 *, unsigned…
      0.0          173,247         61      2,840.1      2,816.0      2,784      2,912         49.1  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0          157,056         61      2,574.7      2,560.0      2,464      2,848         75.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<long, long, bool, …
      0.0          134,815         61      2,210.1      2,240.0      2,112      2,336         58.7  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floa…
      0.0          131,395         61      2,154.0      2,144.0      2,079      2,784         83.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<long, long, long, …
      0.0          126,398         61      2,072.1      2,048.0      1,920      2,272         91.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, at…
      0.0          108,416         61      1,777.3      1,760.0      1,728      2,303         71.1  void <unnamed>::elementwise_kernel_with_index<int, at::native::arange_cuda_out(const c10::Scalar &,…
      0.0            7,936          2      3,968.0      3,968.0      3,872      4,064        135.8  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…
      0.0            7,775          2      3,887.5      3,887.5      3,871      3,904         23.3  void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIterator…
      0.0            5,568          1      5,568.0      5,568.0      5,568      5,568          0.0  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl_nocast<at::n…

[7/8] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count   Avg (ns)  Med (ns)  Min (ns)   Max (ns)   StdDev (ns)      Operation     
 --------  ---------------  ------  --------  --------  --------  ----------  -----------  ------------------
     80.5      467,789,443   8,114  57,652.1   3,456.0     1,023  25,738,426    510,287.5  [CUDA memcpy HtoD]
     16.4       95,484,446  11,712   8,152.7   8,352.0     1,952       9,024        652.1  [CUDA memcpy DtoD]
      2.5       14,536,507  10,311   1,409.8   1,120.0       992       3,904        469.8  [CUDA memset]     
      0.6        3,294,044   1,465   2,248.5   2,209.0     2,175      15,040        353.1  [CUDA memcpy DtoH]

[8/8] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count   Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)      Operation     
 ----------  ------  --------  --------  --------  --------  -----------  ------------------
 97,480.319  11,712     8.323     8.389     0.008     8.389        0.673  [CUDA memcpy DtoD]
  7,037.869   8,114     0.867     0.016     0.000   411.828        7.968  [CUDA memcpy HtoD]
    102.020  10,311     0.010     0.001     0.000     0.033        0.014  [CUDA memset]     
      0.268   1,465     0.000     0.000     0.000     0.262        0.007  [CUDA memcpy DtoH]

Generated:
    /qfs/people/hoan163/project/pythonProfile/SC24-Long-Exposure-AD/report6.nsys-rep
    /qfs/people/hoan163/project/pythonProfile/SC24-Long-Exposure-AD/report6.sqlite
